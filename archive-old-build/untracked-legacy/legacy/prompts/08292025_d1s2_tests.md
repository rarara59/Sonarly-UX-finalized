Run these commands in sequence. If any test fails, you'll need to fix the integration issues before proceeding to Session 3.

--

echo "Session 2 integration testing: $(date)" >> development.log

# Test component factory
node -e "
import('./system/component-factory.js').then(module => {
  console.log('✅ Component factory imported');
  const factory = module.componentFactory;
  return factory.create('rpc-connection-pool', {useFakes: false});
}).then(component => {
  console.log('✅ Real component created via factory');
  return component.call('getSlot', []);
}).then(result => {
  console.log('✅ Component works through factory:', result ? 'SUCCESS' : 'FAILED');
}).catch(err => {
  console.error('❌ Factory test failed:', err.message);
  process.exit(1);
});
" > session2-factory-test.txt 2>&1

# Test system orchestrator
timeout 30 node -e "
import('./system/orchestrator.js').then(module => {
  console.log('✅ System orchestrator imported');
  const orchestrator = new module.SystemOrchestrator();
  return orchestrator.startSystem();
}).then(system => {
  console.log('✅ System started successfully');
  console.log('Active components:', Object.keys(system.components));
  return system.shutdown();
}).then(() => {
  console.log('✅ System shutdown gracefully');
}).catch(err => {
  console.error('❌ System test failed:', err.message);
  process.exit(1);
});
" > session2-system-test.txt 2>&1

# Test real/fake switching
echo "Testing adapter switching..." >> development.log
USE_FAKES=true node -e "
import('./src/adapters/rpc-connection-pool.adapter.js').then(module => {
  console.log('✅ Adapter imported');
  return module.RpcConnectionPoolAdapter.create();
}).then(component => {
  console.log('✅ Fake component created');
  return component.call('getSlot', []);
}).then(result => {
  console.log('✅ Fake component works:', result);
}).catch(console.error);
" > session2-fake-test.txt 2>&1

# Validate integration success
if grep -q '✅.*SUCCESS\|✅.*works' session2-factory-test.txt session2-system-test.txt session2-fake-test.txt; then
  echo "✅ System integration successful" >> development.log
else
  echo "❌ System integration failed - check test outputs" >> development.log
  exit 1
fi

# Document integration capabilities
cat > session2-integration.md << EOF
# Session 2: System Integration Capabilities

## Component Factory
$(cat session2-factory-test.txt)

## System Orchestrator  
$(cat session2-system-test.txt)

## Real/Fake Adapter
$(cat session2-fake-test.txt)

## System Files Created
$(find system/ src/adapters/ tests/ -name "*.js" 2>/dev/null | sort)

## Integration Status
- Component factory: $(grep -q '✅.*created' session2-factory-test.txt && echo "WORKING" || echo "NEEDS REVIEW")
- System orchestrator: $(grep -q '✅.*started' session2-system-test.txt && echo "WORKING" || echo "NEEDS REVIEW")
- Real/fake switching: $(grep -q '✅.*works' session2-fake-test.txt && echo "WORKING" || echo "NEEDS REVIEW")
EOF

git add .
git commit -m "Session 2: Universal system integration for rpc-connection-pool"
echo "Session 2 completed: $(date)" >> development.log

--

