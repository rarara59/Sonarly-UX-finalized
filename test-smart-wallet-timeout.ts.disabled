// test-smart-wallet-timeout.ts
import { connectToDatabase } from './src/config/database';
import SmartWallet from './src/models/smartWallet';

async function testSmartWalletTimeout() {
  try {
    console.log('üîç Testing smart wallet timeout fix...');
    
    // Connect to database with new timeout settings
    await connectToDatabase();
    console.log('‚úÖ Database connected successfully');
    
    // Test querying all smart wallets (this was timing out before)
    const startTime = Date.now();
    const wallets = await SmartWallet.find({ isActive: true });
    const endTime = Date.now();
    
    console.log(`‚úÖ Successfully queried ${wallets.length} smart wallets`);
    console.log(`‚è±Ô∏è  Query took ${endTime - startTime}ms`);
    
    // Test tier distribution (this should work now)
    const tierDist = await SmartWallet.getTierDistribution();
    console.log('üìä Tier distribution:', tierDist);
    
    process.exit(0);
  } catch (error) {
    console.error('‚ùå Test failed:', error);
    process.exit(1);
  }
}

testSmartWalletTimeout();