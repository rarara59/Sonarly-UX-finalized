PROMPT 1D: Connection Pool Core Extraction
SINGLE FOCUS: Extract core HTTP connection management from existing 2000-line RPC connection pool
EXPLICIT FILE PATHS:

Source: src/detection/transport/rpc-connection-pool.js (HTTP agent, socket, keep-alive, timeout sections)
Target: src/detection/transport/connection-pool-core.js

INCREMENTAL IMPLEMENTATION PROCESS:
Step 1: Extract HTTP agent configuration, socket management, and connection lifecycle logic
Step 2: Create ConnectionPoolCore class with connection pooling, reuse, and cleanup methods
Step 3: Test connection lifecycle management in isolation with local test server
Step 4: Test socket reuse efficiency and connection cleanup under various load patterns
Step 5: Create integration stub in original file with core connection methods ready for orchestrator
CLEAR SUCCESS CRITERIA:
Connection Management Requirements:

Socket reuse efficiency: 90%+ of requests use existing pooled connections
Connection cleanup: Zero socket leaks during 1-hour continuous operation
Keep-alive efficiency: Maintain connections for full configured timeout period
Concurrent connection handling: 100 concurrent requests without connection exhaustion

Performance Requirements:

New connection establishment: <50ms for new connections to external services
Socket reuse latency: <5ms overhead for reusing existing pooled connections
Memory per connection: <5KB overhead per active socket in connection pool
Connection cleanup timing: Release unused connections within configured timeout period

Integration Requirements:

Original file compiles successfully after extraction with integration stub
Integration interface: Core connection methods ready for use by other components
Export functionality: import { ConnectionPoolCore } from './connection-pool-core.js' works correctly
Configuration compatibility: Existing HTTP agent configuration environment variables preserved

REQUIREMENTS-BASED VALIDATION:
Measure These Metrics:

Socket reuse percentage (target: 90%+ of requests use existing connections)
Memory leak detection (target: 0 leaked sockets over 1-hour operation)
Connection establishment time (target: <50ms for new connections)
Concurrent request handling capacity (target: 100 concurrent requests without exhaustion)
Connection cleanup timing accuracy (target: Within 10% of configured timeout)