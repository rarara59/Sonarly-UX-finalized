{
  "summary": {
    "totalDiscriminators": 10,
    "lpCreationDiscriminators": 6,
    "mappedLayouts": 3
  },
  "discriminatorDetails": {
    "e7": {
      "name": "initialize2",
      "type": "lp_creation",
      "minAccounts": 19,
      "accountStructure": {
        "0": "TOKEN_PROGRAM",
        "1": "SYSTEM_PROGRAM",
        "2": "RENT_SYSVAR",
        "3": "ASSOCIATED_TOKEN_PROGRAM",
        "4": "AMM_ID",
        "5": "AMM_AUTHORITY",
        "6": "AMM_OPEN_ORDERS",
        "7": "AMM_LP_MINT",
        "8": "AMM_COIN_MINT",
        "9": "AMM_PC_MINT",
        "10": "AMM_COIN_VAULT",
        "11": "AMM_PC_VAULT",
        "12": "AMM_TARGET_ORDERS",
        "13": "SERUM_MARKET",
        "14": "SERUM_PROGRAM",
        "15": "SERUM_COIN_VAULT",
        "16": "SERUM_PC_VAULT",
        "17": "SERUM_VAULT_SIGNER",
        "18": "USER_WALLET"
      }
    },
    "e8": {
      "name": "initialize",
      "type": "lp_creation",
      "minAccounts": 18,
      "accountStructure": {
        "0": "TOKEN_PROGRAM",
        "1": "SYSTEM_PROGRAM",
        "2": "RENT_SYSVAR",
        "3": "AMM_ID",
        "4": "AMM_AUTHORITY",
        "5": "AMM_OPEN_ORDERS",
        "6": "AMM_LP_MINT",
        "7": "AMM_COIN_MINT",
        "8": "AMM_PC_MINT",
        "9": "AMM_COIN_VAULT",
        "10": "AMM_PC_VAULT",
        "11": "AMM_TARGET_ORDERS",
        "12": "SERUM_MARKET",
        "13": "SERUM_PROGRAM",
        "14": "SERUM_COIN_VAULT",
        "15": "SERUM_PC_VAULT",
        "16": "SERUM_VAULT_SIGNER",
        "17": "USER_WALLET"
      }
    },
    "e9": {
      "name": "initialize3",
      "type": "lp_creation",
      "minAccounts": 18,
      "accountStructure": {
        "0": "TOKEN_PROGRAM",
        "1": "SYSTEM_PROGRAM",
        "2": "RENT_SYSVAR",
        "3": "AMM_ID",
        "4": "AMM_AUTHORITY",
        "5": "AMM_OPEN_ORDERS",
        "6": "AMM_LP_MINT",
        "7": "AMM_COIN_MINT",
        "8": "AMM_PC_MINT",
        "9": "AMM_COIN_VAULT",
        "10": "AMM_PC_VAULT",
        "11": "AMM_TARGET_ORDERS",
        "12": "SERUM_MARKET",
        "13": "SERUM_PROGRAM",
        "14": "SERUM_COIN_VAULT",
        "15": "SERUM_PC_VAULT",
        "16": "SERUM_VAULT_SIGNER",
        "17": "USER_WALLET"
      }
    },
    "ea": {
      "name": "initializeV4",
      "type": "lp_creation",
      "minAccounts": 20,
      "accountStructure": {}
    },
    "eb": {
      "name": "initializeV5",
      "type": "lp_creation",
      "minAccounts": 21,
      "accountStructure": {}
    },
    "f8": {
      "name": "createPool",
      "type": "lp_creation",
      "minAccounts": 16,
      "accountStructure": {}
    },
    "09": {
      "name": "swap",
      "type": "swap",
      "minAccounts": 8
    },
    "0a": {
      "name": "swapV2",
      "type": "swap",
      "minAccounts": 9
    },
    "cc": {
      "name": "deposit",
      "type": "liquidity",
      "minAccounts": 10
    },
    "e3": {
      "name": "withdraw",
      "type": "liquidity",
      "minAccounts": 10
    }
  },
  "extractionRules": {
    "e7": {
      "primaryTokenPosition": 8,
      "secondaryTokenPosition": 9,
      "ammIdPosition": 4
    },
    "e8": {
      "primaryTokenPosition": 7,
      "secondaryTokenPosition": 8,
      "ammIdPosition": 3
    },
    "e9": {
      "primaryTokenPosition": 7,
      "secondaryTokenPosition": 8,
      "ammIdPosition": 3
    }
  },
  "recommendations": [
    "Implement dynamic discriminator detection for all LP creation variants",
    "Use discriminator-specific account layouts for accurate token extraction",
    "Add heuristic fallbacks for unknown discriminators",
    "Monitor for new discriminators and update mapping regularly",
    "Implement performance monitoring for extraction accuracy"
  ],
  "implementationPlan": {
    "step1": "Replace static discriminator mapping with complete set",
    "step2": "Implement discriminator-aware token extraction",
    "step3": "Add heuristic extraction for unknown discriminators",
    "step4": "Add monitoring and alerts for unknown discriminators",
    "step5": "Test with known LP creation transactions"
  }
}